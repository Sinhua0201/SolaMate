# ğŸ¤ å¥½å‹ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. **Friends æŒ‰é’®** (æ›¿æ¢äº† Balance æŒ‰é’®)
- ğŸ“ ä½ç½®: å¯¼èˆªæ å³ä¸Šè§’
- ğŸ¨ å›¾æ ‡: Users (ğŸ‘¥)
- ğŸ’» æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯éƒ½å¯ç”¨

### 2. **Friends Modal** (å¥½å‹ç®¡ç†å¼¹çª—)
åŒ…å« 3 ä¸ªä¸»è¦éƒ¨åˆ†:

#### A. æ·»åŠ å¥½å‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Add Friend                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Enter wallet address]  [Send] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- è¾“å…¥å¥½å‹çš„é’±åŒ…åœ°å€
- ç‚¹å‡» "Send Request"
- äº¤æ˜“ä¸Šé“¾ (Solana)

#### B. å¾…å¤„ç†è¯·æ±‚
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Pending Requests (2)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¶ Alice  [@alice]  [âœ“] [âœ—]   â”‚
â”‚ ğŸ± Bob    [@bob]    [âœ“] [âœ—]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- æ˜¾ç¤ºå‘ç»™ä½ çš„å¥½å‹è¯·æ±‚
- âœ“ æ¥å—è¯·æ±‚ (ä¸Šé“¾)
- âœ— æ‹’ç»è¯·æ±‚

#### C. å¥½å‹åˆ—è¡¨
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ My Friends (5)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ° Carol  [@carol]  [ğŸ’¬ Chat]  â”‚
â”‚ ğŸ» Derek  [@derek]  [ğŸ’¬ Chat]  â”‚
â”‚ ğŸ¦ Eve    [@eve]    [ğŸ’¬ Chat]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- æ˜¾ç¤ºæ‰€æœ‰å·²æ¥å—çš„å¥½å‹
- æ˜¾ç¤ºå¥½å‹çš„å® ç‰© emoji
- ç‚¹å‡» Chat æŒ‰é’®è¿›å…¥èŠå¤©

---

## ğŸ”„ å®Œæ•´æµç¨‹

### æ·»åŠ å¥½å‹æµç¨‹
```
1. ç”¨æˆ· A ç‚¹å‡» "Friends" æŒ‰é’®
   â†“
2. è¾“å…¥ç”¨æˆ· B çš„é’±åŒ…åœ°å€
   â†“
3. ç‚¹å‡» "Send Request"
   â†“
4. è°ƒç”¨æ™ºèƒ½åˆçº¦ send_friend_request()
   â†“
5. åˆ›å»º Friendship (status: Pending) â†’ ä¸Šé“¾
   â†“
6. ç”¨æˆ· B æ‰“å¼€ Friends Modal
   â†“
7. çœ‹åˆ° "Pending Requests" ä¸­æœ‰ç”¨æˆ· A
   â†“
8. ç‚¹å‡» âœ“ æ¥å—
   â†“
9. è°ƒç”¨æ™ºèƒ½åˆçº¦ accept_friend_request()
   â†“
10. æ›´æ–° Friendship (status: Accepted) â†’ ä¸Šé“¾
   â†“
11. åŒæ–¹çš„ "My Friends" åˆ—è¡¨ä¸­å‡ºç°å¯¹æ–¹
```

---

## ğŸ¨ UI ç‰¹æ€§

### å® ç‰©æ˜¾ç¤º
- æ¯ä¸ªç”¨æˆ·æ ¹æ®é’±åŒ…åœ°å€è‡ªåŠ¨åˆ†é…ä¸€ä¸ªå® ç‰© (1-10)
- å® ç‰© emoji æ˜¾ç¤ºåœ¨å¥½å‹åˆ—è¡¨ä¸­
- å® ç‰©ä¿¡æ¯æ˜¾ç¤ºåœ¨ Profile Modal ä¸­

### å“åº”å¼è®¾è®¡
- ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯éƒ½å®Œç¾é€‚é…
- æ»šåŠ¨åŒºåŸŸè‡ªåŠ¨è°ƒæ•´é«˜åº¦
- è§¦æ‘¸å‹å¥½çš„æŒ‰é’®å¤§å°

### å®æ—¶æ›´æ–°
- æ¥å—è¯·æ±‚åè‡ªåŠ¨åˆ·æ–°åˆ—è¡¨
- å‘é€è¯·æ±‚åæ¸…ç©ºè¾“å…¥æ¡†
- é”™è¯¯æç¤ºå‹å¥½

---

## ğŸ”— æ•°æ®æµ

### é“¾ä¸Šæ•°æ® (Solana)
```rust
Friendship {
  user_a: Pubkey,  // å­—æ¯åºå°çš„åœ°å€
  user_b: Pubkey,  // å­—æ¯åºå¤§çš„åœ°å€
  status: Pending | Accepted,
  created_at: i64,
}
```

### é“¾ä¸‹æ•°æ® (Firebase)
```javascript
Profile {
  walletAddress: "ABC...",
  username: "alice",
  displayName: "Alice",
  avatar: "base64..." // å•ç‹¬ API è·å–
}
```

### å® ç‰©æ•°æ® (è®¡ç®—)
```javascript
// æ ¹æ®é’±åŒ…åœ°å€å“ˆå¸Œè®¡ç®—
petId = hash(walletAddress) % 10 + 1
```

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. å‡†å¤‡ä¸¤ä¸ªé’±åŒ…
- é’±åŒ… A: ä½ çš„ä¸»é’±åŒ…
- é’±åŒ… B: æµ‹è¯•é’±åŒ… (å¯ä»¥ç”¨ Phantom åˆ›å»ºæ–°è´¦æˆ·)

### 2. æµ‹è¯•æ·»åŠ å¥½å‹
```bash
# é’±åŒ… A
1. è¿æ¥é’±åŒ… A
2. ç‚¹å‡» "Friends" æŒ‰é’®
3. è¾“å…¥é’±åŒ… B çš„åœ°å€
4. ç‚¹å‡» "Send Request"
5. åœ¨ Phantom ä¸­ç¡®è®¤äº¤æ˜“
6. ç­‰å¾…äº¤æ˜“ç¡®è®¤ (~1-2 ç§’)
```

### 3. æµ‹è¯•æ¥å—è¯·æ±‚
```bash
# é’±åŒ… B
1. åˆ‡æ¢åˆ°é’±åŒ… B
2. ç‚¹å‡» "Friends" æŒ‰é’®
3. çœ‹åˆ° "Pending Requests" ä¸­æœ‰é’±åŒ… A
4. ç‚¹å‡» âœ“ æ¥å—
5. åœ¨ Phantom ä¸­ç¡®è®¤äº¤æ˜“
6. ç­‰å¾…äº¤æ˜“ç¡®è®¤
```

### 4. éªŒè¯å¥½å‹åˆ—è¡¨
```bash
# é’±åŒ… A å’Œ B
1. æ‰“å¼€ "Friends" Modal
2. åœ¨ "My Friends" ä¸­çœ‹åˆ°å¯¹æ–¹
3. æ˜¾ç¤ºå¯¹æ–¹çš„ç”¨æˆ·åå’Œå® ç‰©
4. å¯ä»¥ç‚¹å‡» "Chat" æŒ‰é’®
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q: "Account already exists" é”™è¯¯
**åŸå› :** å·²ç»å‘é€è¿‡å¥½å‹è¯·æ±‚
**è§£å†³:** ç­‰å¾…å¯¹æ–¹æ¥å—ï¼Œæˆ–è€…è®©å¯¹æ–¹å…ˆå‘é€è¯·æ±‚ç»™ä½ 

### Q: çœ‹ä¸åˆ°å¾…å¤„ç†è¯·æ±‚
**åŸå› :** 
1. äº¤æ˜“è¿˜æœªç¡®è®¤
2. å¯¹æ–¹è¿˜æœªå‘é€è¯·æ±‚
3. éœ€è¦åˆ·æ–°é¡µé¢

**è§£å†³:** 
1. ç­‰å¾… 1-2 ç§’
2. å…³é—­å¹¶é‡æ–°æ‰“å¼€ Friends Modal
3. åˆ·æ–°é¡µé¢

### Q: å¥½å‹åˆ—è¡¨ä¸ºç©º
**åŸå› :** 
1. è¿˜æ²¡æœ‰æ¥å—çš„å¥½å‹
2. æ•°æ®åŠ è½½ä¸­

**è§£å†³:** 
1. å…ˆæ·»åŠ å¹¶æ¥å—å¥½å‹è¯·æ±‚
2. ç­‰å¾… "Loading..." æ¶ˆå¤±

### Q: å® ç‰©ä¸æ˜¾ç¤º
**åŸå› :** å® ç‰©æ˜¯æ ¹æ®é’±åŒ…åœ°å€è‡ªåŠ¨è®¡ç®—çš„

**è§£å†³:** æ¯ä¸ªé’±åŒ…åœ°å€éƒ½æœ‰å›ºå®šçš„å® ç‰©ï¼Œæ— éœ€è®¾ç½®

---

## ğŸ’¡ ä¸‹ä¸€æ­¥åŠŸèƒ½

### Phase 1 (å½“å‰)
- âœ… æ·»åŠ å¥½å‹
- âœ… æ¥å—è¯·æ±‚
- âœ… å¥½å‹åˆ—è¡¨
- âœ… å® ç‰©æ˜¾ç¤º

### Phase 2 (å³å°†æ¨å‡º)
- â­ï¸ ç‚¹å‡» Chat æŒ‰é’®è¿›å…¥èŠå¤©
- â­ï¸ é“¾ä¸ŠèŠå¤©æ¶ˆæ¯
- â­ï¸ å®æ—¶æ¶ˆæ¯åŒæ­¥

### Phase 3 (æœªæ¥)
- â­ï¸ å¥½å‹åœ¨çº¿çŠ¶æ€
- â­ï¸ å¥½å‹æœç´¢ (æŒ‰ç”¨æˆ·å)
- â­ï¸ å¥½å‹åˆ†ç»„
- â­ï¸ é»‘åå•åŠŸèƒ½

---

## ğŸ¯ æŠ€æœ¯ç»†èŠ‚

### æ™ºèƒ½åˆçº¦è°ƒç”¨
```javascript
// å‘é€å¥½å‹è¯·æ±‚
const { sendFriendRequest } = useSendFriendRequest();
await sendFriendRequest(friendPublicKey);

// æ¥å—å¥½å‹è¯·æ±‚
const { acceptFriendRequest } = useAcceptFriendRequest();
await acceptFriendRequest(friendPublicKey);
```

### è·å–å¥½å‹åˆ—è¡¨
```javascript
const program = getProgram({ publicKey, sendTransaction });
const friendships = await program.account.friendship.all();

// ç­›é€‰ä¸å½“å‰ç”¨æˆ·ç›¸å…³çš„å¥½å‹
const myFriends = friendships.filter(f => 
  f.account.userA.toString() === userAddress ||
  f.account.userB.toString() === userAddress
);
```

### å® ç‰©è®¡ç®—
```javascript
import { getUserPet } from '@/lib/petMapping';

const pet = getUserPet(walletAddress);
// { id: 3, name: 'Bunny', emoji: 'ğŸ°', trait: 'Active' }
```

---

**ç°åœ¨ä½ å¯ä»¥å¼€å§‹æµ‹è¯•å¥½å‹ç³»ç»Ÿäº†ï¼ğŸ‰**

è®¿é—®: http://localhost:3000
ç‚¹å‡»å³ä¸Šè§’çš„ "Friends" æŒ‰é’®å¼€å§‹ï¼
