# ğŸ—ï¸ æ›´æ–°åçš„ç³»ç»Ÿæ¶æ„

## æ•°æ®å­˜å‚¨ç­–ç•¥

### ğŸ“¦ Firebase Firestore (é“¾ä¸‹)
**ç”¨é€”:** å¿«é€Ÿè¯»å†™ã€ç”¨æˆ·ä½“éªŒä¼˜åŒ–

#### å­˜å‚¨å†…å®¹:
1. **ç”¨æˆ·æ¡£æ¡ˆ (profiles)**
   ```javascript
   {
     walletAddress: "ABC...",
     username: "alice",
     displayName: "Alice",
     avatar: "base64...",
     petId: 3,  // å® ç‰© ID
     createdAt: timestamp,
     updatedAt: timestamp
   }
   ```

2. **é€šçŸ¥ (notifications)**
   ```javascript
   {
     to: "wallet_address",
     from: "wallet_address",
     type: "payment_request",
     amount: "0.5",
     message: "...",
     status: "pending",
     timestamp: timestamp
   }
   ```

### â›“ï¸ Solana Blockchain (é“¾ä¸Š)
**ç”¨é€”:** ä¸å¯ç¯¡æ”¹ã€å»ä¸­å¿ƒåŒ–ã€ä¿¡ä»»

#### å­˜å‚¨å†…å®¹:
1. **å¥½å‹å…³ç³» (Friendship)**
   - è¯æ˜å¥½å‹å…³ç³»
   - ä¸å¯ä¼ªé€ 

2. **èŠå¤©æ¶ˆæ¯ (Message)**
   - æ°¸ä¹…è®°å½•
   - ä¸å¯åˆ é™¤/ç¯¡æ”¹

3. **æ¶ˆè´¹è®°å½• (ExpenseRecord)**
   - è´¢åŠ¡å®¡è®¡
   - ç¨åŠ¡è¯æ˜

4. **æ¶ˆè´¹ç»Ÿè®¡ (ExpenseStats)**
   - å®æ—¶ç»Ÿè®¡
   - è‡ªåŠ¨è®¡ç®—

---

## ğŸ”„ å®Œæ•´ç”¨æˆ·æµç¨‹

### 1. æ–°ç”¨æˆ·æ³¨å†Œ
```
1. è¿æ¥é’±åŒ… (Phantom)
   â†“
2. æ£€æŸ¥ Firebase æ˜¯å¦æœ‰æ¡£æ¡ˆ
   â†“
3. å¦‚æœæ²¡æœ‰ â†’ æ˜¾ç¤ºæ¡£æ¡ˆè®¾ç½®å¼¹çª—
   â†“
4. ç”¨æˆ·è¾“å…¥ username + ä¸Šä¼  avatar
   â†“
5. ä¿å­˜åˆ° Firebase (ä¸ä¸Šé“¾)
   â†“
6. å¼•å¯¼é€‰æ‹©å® ç‰©
   â†“
7. å® ç‰© ID ä¿å­˜åˆ° Firebase
   â†“
8. å®Œæˆæ³¨å†Œ
```

### 2. æ·»åŠ å¥½å‹
```
1. ç”¨æˆ·è¾“å…¥å¥½å‹é’±åŒ…åœ°å€
   â†“
2. è°ƒç”¨ send_friend_request() â†’ ä¸Šé“¾
   â†“
3. åˆ›å»º Friendship (status: Pending)
   â†“
4. å‘é€é€šçŸ¥åˆ° Firebase
   â†“
5. å¥½å‹æ”¶åˆ°é€šçŸ¥
   â†“
6. å¥½å‹è°ƒç”¨ accept_friend_request() â†’ ä¸Šé“¾
   â†“
7. æ›´æ–° Friendship (status: Accepted)
   â†“
8. åŒæ–¹æˆä¸ºå¥½å‹
```

### 3. èŠå¤©
```
1. ç”¨æˆ·ç‚¹å‡»å¥½å‹å¤´åƒ
   â†“
2. æ£€æŸ¥æ˜¯å¦æœ‰ ChatRoom (é“¾ä¸Š)
   â†“
3. å¦‚æœæ²¡æœ‰ â†’ è°ƒç”¨ initialize_chat_room()
   â†“
4. ç”¨æˆ·è¾“å…¥æ¶ˆæ¯
   â†“
5. è°ƒç”¨ send_message() â†’ ä¸Šé“¾
   â†“
6. æ¶ˆæ¯æ°¸ä¹…å­˜å‚¨åœ¨åŒºå—é“¾
   â†“
7. å¯¹æ–¹è½®è¯¢è·å–æ–°æ¶ˆæ¯
```

### 4. è½¬è´¦ + è®°å½•æ¶ˆè´¹
```
1. ç”¨æˆ·è¯´ "Send 0.5 SOL to @alice for dinner"
   â†“
2. AI è§£æ: amount=0.5, recipient=alice, category=Dining
   â†“
3. æ‰§è¡Œ SOL è½¬è´¦ (SystemProgram.transfer)
   â†“
4. è½¬è´¦æˆåŠŸ â†’ è·å– tx_signature
   â†“
5. è°ƒç”¨ record_expense() â†’ ä¸Šé“¾
   â†“
6. åˆ›å»º ExpenseRecord (é“¾ä¸Š)
   â†“
7. æ›´æ–° ExpenseStats (é“¾ä¸Š)
   â†“
8. å‰ç«¯æ˜¾ç¤º "è½¬è´¦æˆåŠŸï¼Œå·²è®°å½•"
```

---

## ğŸ“Š å¯¹æ¯”è¡¨

| åŠŸèƒ½ | Firebase | Solana | åŸå›  |
|------|----------|--------|------|
| ç”¨æˆ·æ¡£æ¡ˆ | âœ… | âŒ | é¢‘ç¹æ›´æ–°ï¼Œä¸éœ€è¦ä¸å¯ç¯¡æ”¹ |
| å¤´åƒ | âœ… | âŒ | æ•°æ®é‡å¤§ï¼Œæˆæœ¬é«˜ |
| å® ç‰©é€‰æ‹© | âœ… | âŒ | å¯ä»¥éšæ—¶æ›´æ¢ |
| å¥½å‹å…³ç³» | âŒ | âœ… | éœ€è¦åŒæ–¹ç¡®è®¤ï¼Œä¸å¯ä¼ªé€  |
| èŠå¤©æ¶ˆæ¯ | âŒ | âœ… | æ°¸ä¹…è®°å½•ï¼Œä¸å¯ç¯¡æ”¹ |
| æ¶ˆè´¹è®°å½• | âŒ | âœ… | è´¢åŠ¡å®¡è®¡ï¼Œç¨åŠ¡è¯æ˜ |
| é€šçŸ¥ | âœ… | âŒ | ä¸´æ—¶æ•°æ®ï¼Œå¯åˆ é™¤ |

---

## ğŸ¯ ä¼˜åŠ¿

### Firebase ä¼˜åŠ¿:
- âš¡ å¿«é€Ÿè¯»å†™
- ğŸ’° æˆæœ¬ä½
- ğŸ”„ æ˜“äºæ›´æ–°
- ğŸ“± å®æ—¶åŒæ­¥

### Solana ä¼˜åŠ¿:
- ğŸ”’ ä¸å¯ç¯¡æ”¹
- ğŸŒ å»ä¸­å¿ƒåŒ–
- âœ… å¯éªŒè¯
- ğŸ“œ æ°¸ä¹…å­˜å‚¨

---

## ğŸ’¡ æœ€ä½³å®è·µ

### ä»€ä¹ˆæ—¶å€™ç”¨ Firebase?
- ç”¨æˆ·å¯ä»¥éšæ—¶ä¿®æ”¹çš„æ•°æ®
- ä¸´æ—¶æ•°æ® (é€šçŸ¥)
- å¤§æ–‡ä»¶ (å¤´åƒ)
- éœ€è¦å¿«é€ŸæŸ¥è¯¢çš„æ•°æ®

### ä»€ä¹ˆæ—¶å€™ç”¨ Solana?
- éœ€è¦åŒæ–¹ç¡®è®¤çš„æ•°æ® (å¥½å‹å…³ç³»)
- ä¸å¯ç¯¡æ”¹çš„è®°å½• (èŠå¤©ã€æ¶ˆè´¹)
- è´¢åŠ¡ç›¸å…³æ•°æ®
- éœ€è¦å…¬å¼€éªŒè¯çš„æ•°æ®

---

## ğŸ”§ æŠ€æœ¯å®ç°

### å‰ç«¯è°ƒç”¨ç¤ºä¾‹

#### åˆ›å»ºæ¡£æ¡ˆ (Firebase only)
```javascript
// ä¸éœ€è¦è°ƒç”¨æ™ºèƒ½åˆçº¦
const response = await fetch('/api/profile', {
  method: 'POST',
  body: JSON.stringify({
    walletAddress,
    username,
    avatar,
    petId: 3
  })
});
```

#### æ·»åŠ å¥½å‹ (Solana)
```javascript
// éœ€è¦è°ƒç”¨æ™ºèƒ½åˆçº¦
const { sendFriendRequest } = useSendFriendRequest();
await sendFriendRequest(friendPublicKey);
```

#### å‘é€æ¶ˆæ¯ (Solana)
```javascript
// éœ€è¦è°ƒç”¨æ™ºèƒ½åˆçº¦
const { sendMessage } = useSendMessage();
await sendMessage(friendPublicKey, 'Hello!');
```

---

## ğŸ“ æ›´æ–°çš„åˆçº¦

ç°åœ¨åˆçº¦åªéœ€è¦ 3 ä¸ªæ¨¡å—:
1. âœ… **Social Program** - å¥½å‹å…³ç³»
2. âœ… **Chat Program** - èŠå¤©æ¶ˆæ¯
3. âœ… **Expense Program** - æ¶ˆè´¹è¿½è¸ª

**ç§»é™¤:** UserProfile (æ”¹ç”¨ Firebase)

---

è¿™æ ·è®¾è®¡çš„å¥½å¤„:
- ğŸ’° **èŠ‚çœæˆæœ¬** - æ¡£æ¡ˆæ•°æ®ä¸ä¸Šé“¾
- âš¡ **æå‡é€Ÿåº¦** - Firebase è¯»å†™æ›´å¿«
- ğŸ”„ **çµæ´»æ›´æ–°** - ç”¨æˆ·å¯ä»¥éšæ—¶æ”¹å¤´åƒ/ç”¨æˆ·å
- ğŸ”’ **ä¿è¯å®‰å…¨** - é‡è¦æ•°æ®ä»ç„¶ä¸Šé“¾

å®Œç¾ï¼ğŸ‰
